# 遇上csv文件乱码，先用 记事本 打开文件，在另存为csv文件时选择utf-8转码

# MATCH (n) detach delete n

# 导入作者信息
LOAD CSV WITH HEADERS FROM "file:///citation///e_author_info.csv" AS line
CREATE (Author:Author{authorId:line.authorID, authorName:line.authorName, pc:line.pc, cn:line.cn, hi:line.hi, pi:line.pi, upi:line.upi})

# 导入作者与论文的关系
LOAD CSV WITH HEADERS FROM "file:///citation///r_author_own.csv" AS line
MATCH (FROM:Author{authorId:line.START_ID}), (TO:Paper{paperId:line.END_ID})
MERGE (FROM)-[Author_Paper: Author_Paper{type:line.TYPE, author_pos:line.author_position}]->(TO)

# 导入单位信息
LOAD CSV WITH HEADERS FROM "file:///citation///e_affiliation_info.csv" AS line
CREATE (Affiliation:Affiliation{affiliationId:line.affiliationId, affiliationName:line.affiliationName})


# 导入作者与单位的关系
LOAD CSV WITH HEADERS FROM "file:///citation///r_author_belong.csv" AS line
MATCH (FROM:Author{authorId:line.START_ID}), (TO:Affiliation{affiliationId:line.END_ID})
MERGE (FROM)-[Author_Affiliaion: Author_Affiliaion{type:line.TYPE}]->(TO)


CREATE CONSTRAINT FOR (b: Bank)
ASSERT b.name is UNIQUE

match (n:Series) return n LIMIT 25




